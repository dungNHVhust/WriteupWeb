import pickle
import base64

# Giả sử FLAG là giá trị bí mật trên server mục tiêu
FLAG = "test"

class Exploit:
    def __reduce__(self):
        # Trả về hàm khởi tạo của lớp Exploit để tạo lại đối tượng
        return (self.__class__, ())

# Tạo đối tượng Exploit
exploit = Exploit()

# Chuyển đổi đối tượng thành chuỗi base64 để khai thác
payload = base64.b64encode(pickle.dumps(exploit)).decode()
obj = pickle.loads(base64.b64decode(payload))

# Kiểm tra xem obj có phải là một đối tượng Exploit hay không
print("Payload base64:")
print(payload)
print("Deserialize check: ")
if isinstance(obj, Exploit):
    print("OK")
